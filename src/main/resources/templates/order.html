<!DOCTYPE html>
<html lang="pl">
<th:block th:replace="~{/fragments/headerFragments :: head('Zamówienie')}"></th:block>
<body>
<th:block th:replace="~{/fragments/bodyFragments :: navbar}"></th:block>
<section class="hero-wrap hero-wrap-2 js-fullheight" style="background-image: url('/images/854_hero_2.jpg');" data-stellar-background-ratio="0.5">
    <div class="overlay"></div>
    <div class="container">
        <div class="row no-gutters slider-text js-fullheight align-items-end justify-content-start">
            <div class="col-md-9 ftco-animate pb-5">
                <h1 class="mb-3 bread">Złóż zamówienie</h1>
            </div>
        </div>
    </div>
</section>

<section class="ftco-section contact-section">
    <div class="container">
        <div class="row d-flex mb-5 contact-info">
            <div class="col-md-4">
                <div class="row mb-5">
                    <div class="col-md-12">
                        <div class="border w-100 p-4 rounded mb-2 d-flex">
                            <div class="icon mr-3">
                                <span class="icon-car"></span>
                            </div>
                            <p><span>Pojazd:</span> <span class="text-dark font-weight-bold" th:text="${car.model}"></span></p>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="border w-100 p-4 rounded mb-2 d-flex">
                            <div class="icon mr-3">
                                <span class="icon-star"></span>
                            </div>
                            <p><span>Typ pojazdu:</span> <span class="text-dark font-weight-bold" th:text="${car.model.carType}"></span></p>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="border w-100 p-4 rounded mb-2 d-flex">
                            <div class="icon mr-3">
                                <span class="icon-date_range"></span>
                            </div>
                            <p><span>Data:</span> <span class="text-dark font-weight-bold" th:text="${pickDate} + ' - ' + ${returnDate}"></span></p>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="border w-100 p-4 rounded mb-2 d-flex">
                            <div class="icon mr-3">
                                <span class="icon-money"></span>
                            </div>
                            <p><span>Cena za dzień (zł):</span> <span class="text-dark font-weight-bold" th:text="${order.car.price}"></span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-8 block-9 mb-md-5">
                <form th:action="@{/order/create}" th:object="${order}" method="post" class="bg-light p-5 contact-form">
                    <div id="step1">
                        <h3>Dane osobowe</h3>
                        <div class="form-group">
                            <input type="text" class="form-control" th:field="*{userDetails.firstName}" placeholder="Imię" required>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" th:field="*{userDetails.lastName}" placeholder="Nazwisko" required>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" th:field="*{userDetails.phoneNumber}" placeholder="Nr telefonu" required>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" th:field="*{userDetails.postalCode}" placeholder="Kod pocztowy" required>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" th:field="*{userDetails.city}" placeholder="Miasto" required>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" th:field="*{userDetails.address}" placeholder="Adres" required>
                        </div>
                        <div class="form-group">
                            <button type="button" onclick="next()" class="btn btn-primary py-3 px-5">Dalej</button>
                            <p class="small text-secondary p-2">Zmiana danych w formularzu zaktualizuje twoje dane osobowe!</p>
                        </div>
                    </div>
                    <div id="step2" class="d-none">
                        <h3>Pozostałe informacje</h3>
                        <div class="form-group">
                            <select th:field="*{pickUpCityId}" class="form-control">
                                <option value="" disabled>Wybierz miasto odbioru...</option>
                                <option th:each="city : ${cities}" th:value="${city.id}" th:text="${city.name}"></option>
                            </select>
                        </div>
                        <div class="form-group">
                            <select th:field="*{returnCityId}" class="form-control">
                                <option value="" disabled>Wybierz miasto odbioru...</option>
                                <option th:each="city : ${cities}" th:value="${city.id}" th:text="${city.name}"></option>
                            </select>
                        </div>
                        <div class="form-group">
                            <textarea th:field="*{additionalInfo}" rows="4" class="form-control" placeholder="Dodatkowe informacje"></textarea>
                        </div>
                        <input type="hidden" name="carId" th:value="*{car.id}">
                        <input type="hidden" th:field="*{pickUpDate}">
                        <input type="hidden" th:field="*{returnDate}">
                        <div class="form-group d-flex justify-content-between">
                            <button type="button" onclick="previous()" class="btn btn-primary py-3 px-5">Powrót</button>
                            <button type="submit" class="btn btn-primary py-3 px-5">Przejdź do podsumowania</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<th:block th:replace="~{/fragments/bodyFragments :: footer}"></th:block>
<th:block th:replace="~{/fragments/bodyFragments :: loader}"></th:block>
<th:block th:replace="~{/fragments/bodyFragments :: scripts}"></th:block>
<script>
    function next() {
        const inputs = document.querySelectorAll('#step1 input');
        let allFilled = true;
        inputs.forEach(input => {
            if (!input.value.trim()) {
                input.classList.add('is-invalid');
                allFilled = false;
            } else {
                input.classList.remove('is-invalid');
            }
        });
        if (allFilled) {
            document.getElementById('step1').className = 'd-none';
            document.getElementById('step2').className = 'd-block';
        }
    }

    function previous() {
        document.getElementById('step2').className = 'd-none';
        document.getElementById('step1').className = 'd-block';
    }
</script>
</body>
</html>